

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>aspcol.planewaves.find_matching_plane_wave &mdash; aspcol 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=e3a6060d"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="aspcol.planewaves.linear_directivity_function" href="aspcol.planewaves.linear_directivity_function.html" />
    <link rel="prev" title="aspcol.planewaves.apply_measurement" href="aspcol.planewaves.apply_measurement.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            aspcol
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="aspcol.distance.html">aspcol.distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.kernelinterpolation.html">aspcol.kernelinterpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.kernelinterpolation_jax.html">aspcol.kernelinterpolation_jax</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="aspcol.planewaves.html">aspcol.planewaves</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.apply_measurement.html">aspcol.planewaves.apply_measurement</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">aspcol.planewaves.find_matching_plane_wave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aspcol.planewaves.find_matching_plane_wave"><code class="docutils literal notranslate"><span class="pre">find_matching_plane_wave()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.linear_directivity_function.html">aspcol.planewaves.linear_directivity_function</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.omni_directivity_function.html">aspcol.planewaves.omni_directivity_function</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.plane_wave.html">aspcol.planewaves.plane_wave</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.plane_wave_integral.html">aspcol.planewaves.plane_wave_integral</a></li>
<li class="toctree-l2"><a class="reference internal" href="aspcol.planewaves.shd_coeffs_for_planewave.html">aspcol.planewaves.shd_coeffs_for_planewave</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.plot.html">aspcol.plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.soundfieldcontrol.html">aspcol.soundfieldcontrol</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.soundfieldestimation.html">aspcol.soundfieldestimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.soundfieldestimation_jax.html">aspcol.soundfieldestimation_jax</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.spatialcovarianceestimation.html">aspcol.spatialcovarianceestimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.sphericalharmonics.html">aspcol.sphericalharmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="aspcol.utilities.html">aspcol.utilities</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">aspcol</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="aspcol.planewaves.html">aspcol.planewaves</a></li>
      <li class="breadcrumb-item active">aspcol.planewaves.find_matching_plane_wave</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/aspcol.planewaves.find_matching_plane_wave.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aspcol-planewaves-find-matching-plane-wave">
<h1>aspcol.planewaves.find_matching_plane_wave<a class="headerlink" href="#aspcol-planewaves-find-matching-plane-wave" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="aspcol.planewaves.find_matching_plane_wave">
<span class="sig-prename descclassname"><span class="pre">aspcol.planewaves.</span></span><span class="sig-name descname"><span class="pre">find_matching_plane_wave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plane_wave_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pw_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_mic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#aspcol.planewaves.find_matching_plane_wave" title="Link to this definition"></a></dt>
<dd><p>Matches a plane wave to the given data</p>
<p>The function returns directly the sound pressure of the matched plane wave, but also
enough information for the plane wave to be recreated as gain_adjustment * pw.plane_wave(pos_mic, pw_dir, wave_num, exp_center)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plane_wave_data</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>num_mic</em><em>, </em><em>1</em><em>)</em>) – data from a plane wave or plane-wave like sound field that should be matched by the analytic plane wave</p></li>
<li><p><strong>freq</strong> (<em>float</em>) – frequency of the plane wave</p></li>
<li><p><strong>pw_dir</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>1</em><em>, </em><em>3</em><em>)</em>) – Direction from which the plane wave is incoming. Must be a unit vector</p></li>
<li><p><strong>pos_mic</strong> (<em>ndarray</em><em> of </em><em>shape</em><em> (</em><em>num_mic</em><em>, </em><em>3</em><em>)</em>) – positions of the microphones (the points where the plane wave and the plane_wave_data are measured)</p></li>
<li><p><strong>c</strong> (<em>float</em>) – speed of sound</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>p_mic_analytic</strong> (<em>ndarray of shape (num_mic, 1)</em>) – the sound pressure at pos_mic of the analytic plane wave that matches the plane_wave_data.
If plane_wave_data is a plane wave or very close, then p_mic_analytic should be
essentially identical to plane_wave_data</p></li>
<li><p><strong>exp_center</strong> (<em>ndarray of shape (1, 3)</em>) – the expansion center of the plane wave</p></li>
<li><p><strong>gain_adjustment</strong> (<em>float</em>) – A gain adjustment that should be applied to the analytic plane wave to match the plane_wave_data</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The gain adjustment is found as the mean amplitude of the plane_wave_data.</p>
<p>The phase adjustment is found as the solution to $lVert e^{i gamma} bm{p} - bm{s} rVert_2^2$, where $bm{p}$ is
the vector of analytic pressure values and $bm{s}$ is the vector of plane_wave_data. The solution is found analytically
by taking the derivative and setting to zero.</p>
<p>The expansion center is defined by $exp(-ik(r-r_c)^T d) = exp(-i gamma) exp(ikr^T d)$, where r_c is the unknown expansion center
and the phase adjustment gamma is found by the algorithm. Since that relationship is not necessarily unique, the
expansion center is found as min lVert r_c rVert_2^2 subject to r_c^T d = gamma / wave_num, which is a
least squares problem with linear constrained, solved analytically using the Lagrange multiplier method.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="aspcol.planewaves.apply_measurement.html" class="btn btn-neutral float-left" title="aspcol.planewaves.apply_measurement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="aspcol.planewaves.linear_directivity_function.html" class="btn btn-neutral float-right" title="aspcol.planewaves.linear_directivity_function" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jesper Brunnström.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>